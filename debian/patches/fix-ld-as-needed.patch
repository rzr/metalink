Subject: Fixed build dependencies so that ld runs with --as-needed.
Origin: http://launchpadlibrarian.net/79905667/metalink_0.3.6-1_0.3.6-1ubuntu1.diff.gz
Bug-Debian: http://bugs.debian.org/641641 
--- a/Makefile.am
+++ b/Makefile.am
@@ -5,7 +5,6 @@
 
 #Sources, generated list from ccbuild md5 output
 metalink_SOURCES = src/metalink.cc src/Preprocessor/os_win.hh src/Preprocessor/debug.hh src/String/String.hh src/String/translated.cc src/String/String.ih src/String/toUpper.cc src/Preprocessor/foreach.hh src/Globals/Globals.hh src/Globals/statics.cc src/Globals/Globals.ih src/Globals/XMLSafe.cc src/Globals/XMLQuotedSafe.cc src/Hash/HashPieces/HashPieces.hh src/Hash/HashPieces/xml.cc src/Hash/HashPieces/HashPieces.ih src/Hash/HashPieces/value.cc src/Hash/HashPieces/update.cc src/Hash/HashPieces/name.cc src/Hash/HashPieces/finalize.cc src/Hash/HashPieces/HashPieces.cc src/Hash/GCrypt/GCrypt.hh src/Hash/GCrypt/value.cc src/Hash/GCrypt/GCrypt.ih src/Hash/GCrypt/update.cc src/Hash/GCrypt/name.cc src/Hash/GCrypt/from.cc src/Hash/GCrypt/finalize.cc src/Hash/Hash.hh src/Hash/xml.cc src/Hash/Hash.ih src/Hash/HashGNUnet/HashGNUnet.hh src/Hash/HashGNUnet/value.cc src/Hash/HashGNUnet/HashGNUnet.ih src/Hash/HashGNUnet/update.cc src/Hash/HashGNUnet/pushChk.cc src/Hash/HashGNUnet/gnunettisch.cc src/Hash/HashGNUnet/finalize.cc src/Hash/HashGNUnet/encryptBlock.cc src/Hash/HashGNUnet/blockKeyAndQuery.cc src/Hash/HashGNUnet/blockKey.cc src/Hash/HashGNUnet/HashGNUnet.cc src/Hash/HashSHA512/HashSHA512.hh src/Hash/HashGNUnet/SessionKey/SessionKey.hh src/Hash/HashGNUnet/SessionKey/statics.cc src/Hash/HashGNUnet/SessionKey/SessionKey.ih src/Hash/HashGNUnet/SessionKey/fromHash.cc src/Hash/HashCRC32/HashCRC32.hh src/Hash/HashCRC32/from.cc src/Hash/HashCRC32/HashCRC32.ih src/Hash/HashED2K/HashED2K.hh src/Hash/HashED2K/value.cc src/Hash/HashED2K/HashED2K.ih src/Hash/HashED2K/update.cc src/Hash/HashED2K/finalize.cc src/Hash/HashMD4/HashMD4.hh src/HashList/HashList.hh src/HashList/update.cc src/HashList/HashList.ih src/HashList/finalize.cc src/HashList/destroyMembers.cc src/MD5File/MD5File.hh src/MD5File/record.cc src/MD5File/MD5File.ih src/MetalinkFile/MetalinkFile.hh src/MetalinkFile/finalize.cc src/MetalinkFile/MetalinkFile.ih src/MetalinkFile/addPath.cc src/MirrorList/MirrorList.hh src/MirrorList/MirrorList.cc src/MirrorList/MirrorList.ih src/Mirror/Mirror.hh src/Mirror/asXMLWithFile.cc src/Mirror/Mirror.ih src/Mirror/Mirror.cc src/Metalink/Metalink.hh src/Metalink/from.cc src/Metalink/Metalink.ih src/Options/Options.hh src/Options/Options.cc src/Options/Options.ih 
-metalink_LDFLAGS = @LIBGCRYPT_LIBS@
 metalink_CXXFLAGS = @LIBGCRYPT_CFLAGS@ -D_LARGEFILE_SOURCE $(DEPS_CFLAGS)
-metalink_LDADD = $(DEPS_LIBS)
+metalink_LDADD = @LIBGCRYPT_LIBS@ $(DEPS_LIBS)
 dist_man_MANS = doc/metalink.1
--- a/Makefile.in
+++ b/Makefile.in
@@ -267,9 +267,8 @@
 	src/Metalink/Metalink.hh src/Metalink/from.cc \
 	src/Metalink/Metalink.ih src/Options/Options.hh \
 	src/Options/Options.cc src/Options/Options.ih
-metalink_LDFLAGS = @LIBGCRYPT_LIBS@
 metalink_CXXFLAGS = @LIBGCRYPT_CFLAGS@ -D_LARGEFILE_SOURCE $(DEPS_CFLAGS)
-metalink_LDADD = $(DEPS_LIBS)
+metalink_LDADD = $(DEPS_LIBS) @LIBGCRYPT_LIBS@
 dist_man_MANS = doc/metalink.1
 all: all-am
 
